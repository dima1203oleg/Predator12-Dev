#!/bin/bash

echo "üö® –Ø–î–ï–†–ù–ê –ü–ï–†–ï–ë–£–î–û–í–ê –§–†–û–ù–¢–ï–ù–î–£ üö®"
echo "========================================"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é
cd /Users/dima/Documents/Predator12/predator12-local

echo "1. –ó—É–ø–∏–Ω–∫–∞ –≤—Å—ñ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤..."
docker-compose down

echo "2. –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –æ–±—Ä–∞–∑—ñ–≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É..."
docker rmi predator12-local-frontend:latest 2>/dev/null || echo "–û–±—Ä–∞–∑ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ"

echo "3. –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É..."
cd frontend

echo "4. –û—á–∏—â–µ–Ω–Ω—è –∫–µ—à—É npm..."
npm cache clean --force

echo "5. –í–∏–¥–∞–ª–µ–Ω–Ω—è node_modules —Ç–∞ dist..."
rm -rf node_modules dist

echo "6. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π..."
npm install

echo "7. –ü–µ—Ä–µ–±—É–¥–æ–≤–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É..."
npm run build

echo "8. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É build..."
ls -la dist/
echo "–í–º—ñ—Å—Ç index.html:"
head -10 dist/index.html

echo "9. –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –∫–æ—Ä–Ω–µ–≤–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó..."
cd ..

echo "10. –ü–µ—Ä–µ–±—É–¥–æ–≤–∞ Docker –æ–±—Ä–∞–∑—É..."
docker-compose build --no-cache frontend

echo "11. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤..."
docker-compose up -d

echo "12. –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –∑–∞–ø—É—Å–∫—É..."
sleep 10

echo "13. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É..."
docker-compose ps frontend

echo "14. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ..."
curl -f http://localhost:3000/ && echo "‚úÖ Frontend –¥–æ—Å—Ç—É–ø–Ω–∏–π" || echo "‚ùå Frontend –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π"

echo "========================================"
echo "üéâ –Ø–î–ï–†–ù–ê –ü–ï–†–ï–ë–£–î–û–í–ê –ó–ê–í–ï–†–®–ï–ù–ê!"
echo "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ http://localhost:3000"
