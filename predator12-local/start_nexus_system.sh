#!/bin/bash

# üöÄ –ó–ê–ü–£–°–ö PREDATOR ANALYTICS NEXUS CORE V2.0
# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Å–∞–º–æ–≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è —Ç–∞ –±—ñ–∑–Ω–µ—Å-–∞–Ω–∞–ª—ñ—Ç–∏–∫–∏

echo "üöÄ –ó–∞–ø—É—Å–∫ Predator Analytics Nexus Core v2.0..."
echo "================================================"

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Docker
echo "üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Docker..."
if ! command -v docker &> /dev/null; then
    echo "‚ùå Docker –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–±–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ"
    echo "üìã –ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø—É—Å—Ç—ñ—Ç—å Docker Desktop"
    exit 1
fi

# –ü–µ—Ä–µ—Ö—ñ–¥ –≤ —Ä–æ–±–æ—á—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é
cd "$(dirname "$0")" || exit 1

echo "üìÅ –†–æ–±–æ—á–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è: $(pwd)"

# –ó–∞–ø—É—Å–∫ –≤—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
echo "üê≥ –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤..."
docker-compose up -d

echo "‚è≥ –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤—ñ—Å—ñ–≤ (30 —Å–µ–∫—É–Ω–¥)..."
sleep 30

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
echo "üìä –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤:"
docker-compose ps

echo ""
echo "üåê –î–æ—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏:"
echo "=================================="
echo "üéØ –ì–æ–ª–æ–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å:     http://localhost:3001"
echo "üìä Backend API:            http://localhost:8000"
echo "üìà Grafana –î–∞—à–±–æ—Ä–¥–∏:       http://localhost:3001"
echo "üîç Prometheus –ú–µ—Ç—Ä–∏–∫–∏:     http://localhost:9090"
echo "üîé OpenSearch Dashboards:  http://localhost:5601"
echo "üîê Keycloak Auth:          http://localhost:8080"

echo ""
echo "ü§ñ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–≥–µ–Ω—Ç—ñ–≤ —Å–∞–º–æ–≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è..."
echo "========================================="

# –ß–µ–∫–∞—î–º–æ —â–µ —Ç—Ä–æ—Ö–∏ –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É
sleep 30

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—É –∞–≥–µ–Ω—Ç—ñ–≤
if [ -f "scripts/test_self_healing_agents.py" ]; then
    echo "üîß –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—É –∞–≥–µ–Ω—Ç—ñ–≤ —Å–∞–º–æ–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è..."
    python3 scripts/test_self_healing_agents.py
fi

if [ -f "scripts/test_all_26_agents.py" ]; then
    echo "üéØ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—É –≤—Å—ñ—Ö 26 –∞–≥–µ–Ω—Ç—ñ–≤..."
    python3 scripts/test_all_26_agents.py
fi

echo ""
echo "‚úÖ –°–ò–°–¢–ï–ú–ê –ó–ê–ü–£–©–ï–ù–ê –¢–ê –ì–û–¢–û–í–ê –î–û –†–û–ë–û–¢–ò!"
echo "üéâ –í—ñ–¥–∫—Ä–∏–π—Ç–µ http://localhost:3001 –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É"
echo "üìä –ê–≥–µ–Ω—Ç–∏ —Å–∞–º–æ–≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ —Ç–∞ –ø—Ä–∞—Ü—é—é—Ç—å!"

# –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥—ñ–≤
echo ""
echo "üìù –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥—ñ–≤ —Å–∏—Å—Ç–µ–º–∏ (Ctrl+C –¥–ª—è –≤–∏—Ö–æ–¥—É):"
echo "================================================"
docker-compose logs -f agent-supervisor backend modelsdk
