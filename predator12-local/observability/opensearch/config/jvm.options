# OpenSearch JVM Configuration
# WARNING: This is a critical configuration file for JVM options
# Do not modify unless you understand the implications

################################################################
## EXPERT SETTINGS
################################################################
##
## All settings below this section are considered
## expert settings. Don't tamper with them unless
## you understand what you are doing
##
################################################################

## GC configuration
8-13:-XX:+UseConcMarkSweepGC
8-13:-XX:CMSInitiatingOccupancyFraction=75
8-13:-XX:+UseCMSInitiatingOccupancyOnly

## G1GC Configuration
# NOTE: G1GC is only supported on JDK version 10 or later
# to use G1GC, uncomment the next two lines and comment the CMS settings above.
14-:-XX:+UseG1GC

## JVM temporary directory
-Djava.io.tmpdir=${OPENSEARCH_TMPDIR}

## heap dumps

# generate a heap dump when an allocation from the Java heap fails
# heap dumps are created in the working directory of the JVM
-XX:+HeapDumpOnOutOfMemoryError

# specify an alternative path for heap dumps
# ensure the directory exists and has sufficient space
-XX:HeapDumpPath=/var/lib/opensearch

# specify an alternative path for JVM fatal error logs
-XX:ErrorFile=/var/lib/opensearch/hs_err_pid%p.log

## JDK 8 GC logging
8:-XX:+PrintGC
8:-XX:+PrintGCDetails
8:-XX:+PrintGCTimeStamps
8:-XX:+PrintGCDateStamps
8:-XX:+PrintGCApplicationStoppedTime
8:-XX:+PrintGCApplicationConcurrentTime
8:-XX:+PrintTenuringDistribution
8:-XX:+UseGCLogFileRotation
8:-XX:NumberOfGCLogFiles=32
8:-XX:GCLogFileSize=64m

# JDK 9+ GC logging
9-:-Xlog:gc*,gc+age=trace,safepoint:gc.log:utctime,pid,tags:filecount=32,filesize=64m

# Explicitly allow security manager (JDK 18+)
18-:-Djava.security.manager=allow
